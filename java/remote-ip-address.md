We have a Java Servlet application deployed on Azure App Service (Linux Tomcat stack). We want to record the client ip address using request.getRemoteAddr() method. However, Azure automatically modified the remoteAddr to a value based on the X-Forwarded-For header, which is originally set by a ZScaler's proxy server, with a NAT port in it. So the X-Forwarded-For is like "139.1.2.3, 132.5.6.7:35454", and the request.getRemoteAddr() is like "139.1.2.3, 132.5.6.7". I believe that the handling in Azure will cause problems because we only want the first ip address in the XFF header. However, since Azure already processed the request.getRemoteAddr(), we are unable to use tomcat's RemoteIpFilter directly (The remoteAddr will not be trustedProxy or internalProxy). The RemoteIpFilter is unable to handle address like "139.1.2.3, 132.5.6.7:35454" or "[fed4:0:0:0:0:0:0:1234]:35454" either. What should I do? 